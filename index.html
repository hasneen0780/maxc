<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام التعليم | Max 2025</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            transition: var(--transition);
        }

        body.dark-mode {
            background-color: #1a1a1a;
            color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 0;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .auth-buttons button {
            background-color: white;
            color: var(--primary-color);
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            margin-right: 10px;
            transition: var(--transition);
        }

        .auth-buttons button:hover {
            background-color: var(--light-color);
        }

        .mode-toggle {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .teachers-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: var(--dark-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .teachers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .teacher-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .teacher-card.dark-mode {
            background-color: #2d2d2d;
        }

        .teacher-img {
            height: 200px;
            background-color: var(--light-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: var(--dark-color);
        }

        .teacher-info {
            padding: 15px;
        }

        .teacher-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .teacher-desc {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .teacher-card.dark-mode .teacher-desc {
            color: #ccc;
        }

        .view-btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            text-decoration: none;
            transition: var(--transition);
        }

        .view-btn:hover {
            background-color: var(--secondary-color);
        }

        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .login-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .login-form {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 400px;
            box-shadow: var(--box-shadow);
        }

        .login-form.dark-mode {
            background-color: #2d2d2d;
        }

        .form-title {
            font-size: 22px;
            margin-bottom: 20px;
            text-align: center;
            color: var(--dark-color);
        }

        .login-form.dark-mode .form-title {
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px;
            width: 100%;
            border-radius: var(--border-radius);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        .submit-btn:hover {
            background-color: var(--secondary-color);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }

        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-header {
            background-color: var(--dark-color);
            color: white;
            padding: 15px 0;
            margin-bottom: 30px;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        .admin-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-nav-links a {
            color: white;
            text-decoration: none;
            margin-right: 15px;
            transition: var(--transition);
        }

        .admin-nav-links a:hover {
            color: var(--light-color);
        }

        .admin-content {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .admin-content.dark-mode {
            background-color: #2d2d2d;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #219653;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background-color: #d35400;
        }

        .lectures-list {
            margin-top: 20px;
        }

        .lecture-item {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lecture-item.dark-mode {
            background-color: #3d3d3d;
        }

        .lecture-title {
            font-weight: bold;
        }

        .lecture-link {
            color: var(--primary-color);
            text-decoration: none;
        }

        .lecture-link:hover {
            text-decoration: underline;
        }

        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 20px 0;
            text-align: center;
            margin-top: 50px;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .copyright {
            margin-bottom: 10px;
        }

        .telegram-link {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .telegram-link:hover {
            color: var(--light-color);
        }

        .error-message {
            color: var(--danger-color);
            margin-top: 5px;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .teachers-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <!-- الواجهة الرئيسية للمستخدم العادي -->
    <div class="main-interface">
        <header>
            <div class="container header-content">
                <div class="logo">نظام التعليم</div>
                <div class="auth-buttons">
                    <button id="admin-login-btn">دخول الأدمن</button>
                    <button class="mode-toggle" id="mode-toggle">🌙</button>
                </div>
            </div>
        </header>

        <div class="container">
            <section class="teachers-section">
                <h2 class="section-title">المدرسون لدينا</h2>
                <div class="teachers-grid" id="teachers-container">
                    <!-- سيتم ملء هذا القسم بالبيانات من localStorage -->
                </div>
            </section>

            <section class="lectures-section" id="lectures-section" style="display: none;">
                <h2 class="section-title" id="lectures-title">محاضرات الأستاذ</h2>
                <div class="lectures-list" id="lectures-container">
                    <!-- سيتم ملء هذا القسم بالبيانات من localStorage -->
                </div>
            </section>
        </div>

        <footer>
            <div class="container footer-content">
                <div class="copyright">جميع الحقوق محفوظة &copy; Max 2025</div>
                <a href="#" class="telegram-link">
                    <span>قناتنا على تليجرام</span>
                </a>
            </div>
        </footer>
    </div>

    <!-- نموذج تسجيل الدخول -->
    <div class="login-modal" id="login-modal">
        <button class="close-btn" id="close-login-modal">✕</button>
        <div class="login-form">
            <h2 class="form-title">تسجيل دخول الأدمن</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">اسم المستخدم</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">كلمة المرور</label>
                    <input type="password" id="password" required>
                </div>
                <div id="login-error" class="error-message" style="display: none;"></div>
                <button type="submit" class="submit-btn">دخول</button>
            </form>
        </div>
    </div>

    <!-- لوحة التحكم الخاصة بالأدمن -->
    <div class="admin-panel" id="admin-panel">
        <header class="admin-header">
            <div class="container admin-nav">
                <div class="logo">لوحة التحكم</div>
                <nav class="admin-nav-links">
                    <a href="#" id="admin-home-link">الرئيسية</a>
                    <a href="#" id="add-teacher-link">إضافة مدرس</a>
                    <a href="#" id="logout-link">تسجيل خروج</a>
                    <button class="mode-toggle admin-mode-toggle" id="admin-mode-toggle">🌙</button>
                </nav>
            </div>
        </header>

        <div class="container">
            <!-- قسم إدارة المدرسين -->
            <div class="admin-content" id="admin-teachers-section">
                <h2 class="section-title">إدارة المدرسين</h2>
                <div class="teachers-grid" id="admin-teachers-container">
                    <!-- سيتم ملء هذا القسم بالبيانات من localStorage -->
                </div>
            </div>

            <!-- قسم إضافة مدرس جديد -->
            <div class="admin-content" id="add-teacher-section" style="display: none;">
                <h2 class="section-title">إضافة مدرس جديد</h2>
                <form id="add-teacher-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="teacher-name">اسم المدرس</label>
                            <input type="text" id="teacher-name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="teacher-desc">وصف المدرس</label>
                        <textarea id="teacher-desc" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: var(--border-radius);" required></textarea>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">حفظ</button>
                        <button type="button" class="btn btn-danger" id="cancel-add-teacher">إلغاء</button>
                    </div>
                </form>
            </div>

            <!-- قسم إدارة المحاضرات لمدرس معين -->
            <div class="admin-content" id="manage-lectures-section" style="display: none;">
                <h2 class="section-title" id="manage-lectures-title">إدارة محاضرات الأستاذ</h2>
                <button class="btn btn-primary" id="add-lecture-btn">إضافة فصل جديد</button>
                <div class="lectures-list" id="admin-lectures-container">
                    <!-- سيتم ملء هذا القسم بالبيانات من localStorage -->
                </div>
            </div>

            <!-- قسم إضافة/تعديل فصل -->
            <div class="admin-content" id="add-lecture-section" style="display: none;">
                <h2 class="section-title" id="lecture-form-title">إضافة فصل جديد</h2>
                <form id="lecture-form">
                    <input type="hidden" id="lecture-id">
                    <input type="hidden" id="teacher-id">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lecture-title">عنوان الفصل</label>
                            <input type="text" id="lecture-title" required>
                        </div>
                        <div class="form-group">
                            <label for="lecture-link">رابط الفصل</label>
                            <input type="url" id="lecture-link" required>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary" id="save-lecture-btn">حفظ</button>
                        <button type="button" class="btn btn-danger" id="cancel-lecture-btn">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>

        <footer>
            <div class="container footer-content">
                <div class="copyright">جميع الحقوق محفوظة &copy; Max 2025</div>
                <a href="#" class="telegram-link">
                    <span>قناتنا على تليجرام</span>
                </a>
            </div>
        </footer>
    </div>

    <script>
        // بيانات التطبيق
        let teachers = JSON.parse(localStorage.getItem('teachers')) || [];
        let currentTeacherId = null;
        let currentLectureId = null;
        let isAdmin = false;
        let isEditMode = false;
        let darkMode = localStorage.getItem('darkMode') === 'true';

        // عناصر DOM
        const mainInterface = document.querySelector('.main-interface');
        const adminPanel = document.getElementById('admin-panel');
        const loginModal = document.getElementById('login-modal');
        const loginForm = document.getElementById('login-form');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const closeLoginModal = document.getElementById('close-login-modal');
        const loginError = document.getElementById('login-error');
        const teachersContainer = document.getElementById('teachers-container');
        const adminTeachersContainer = document.getElementById('admin-teachers-container');
        const addTeacherSection = document.getElementById('add-teacher-section');
        const addTeacherForm = document.getElementById('add-teacher-form');
        const cancelAddTeacher = document.getElementById('cancel-add-teacher');
        const manageLecturesSection = document.getElementById('manage-lectures-section');
        const adminLecturesContainer = document.getElementById('admin-lectures-container');
        const addLectureBtn = document.getElementById('add-lecture-btn');
        const addLectureSection = document.getElementById('add-lecture-section');
        const lectureForm = document.getElementById('lecture-form');
        const cancelLectureBtn = document.getElementById('cancel-lecture-btn');
        const lecturesSection = document.getElementById('lectures-section');
        const lecturesContainer = document.getElementById('lectures-container');
        const lecturesTitle = document.getElementById('lectures-title');
        const modeToggle = document.getElementById('mode-toggle');
        const adminModeToggle = document.getElementById('admin-mode-toggle');
        const logoutLink = document.getElementById('logout-link');
        const addTeacherLink = document.getElementById('add-teacher-link');
        const adminHomeLink = document.getElementById('admin-home-link');
        const adminTeachersSection = document.getElementById('admin-teachers-section');

        // تهيئة الوضع الليلي
        function initDarkMode() {
            if (darkMode) {
                document.body.classList.add('dark-mode');
                document.querySelectorAll('.teacher-card, .admin-content, .login-form').forEach(el => {
                    el.classList.add('dark-mode');
                });
                document.querySelectorAll('.lecture-item').forEach(el => {
                    el.classList.add('dark-mode');
                });
                modeToggle.textContent = '☀️';
                adminModeToggle.textContent = '☀️';
            }
        }

        // تحميل البيانات الأولية
        function loadData() {
            renderTeachers();
            initDarkMode();
        }

        // عرض المدرسين
        function renderTeachers() {
            teachersContainer.innerHTML = '';
            adminTeachersContainer.innerHTML = '';

            if (teachers.length === 0) {
                teachersContainer.innerHTML = '<p>لا يوجد مدرسون متاحون حالياً</p>';
                adminTeachersContainer.innerHTML = '<p>لا يوجد مدرسون متاحون حالياً</p>';
                return;
            }

            teachers.forEach(teacher => {
                // عرض للمستخدم العادي
                const teacherCard = document.createElement('div');
                teacherCard.className = 'teacher-card';
                if (darkMode) teacherCard.classList.add('dark-mode');
                teacherCard.innerHTML = `
                    <div class="teacher-img">${teacher.name.charAt(0)}</div>
                    <div class="teacher-info">
                        <h3 class="teacher-name">${teacher.name}</h3>
                        <p class="teacher-desc">${teacher.desc}</p>
                        <a href="#" class="view-btn" data-teacher-id="${teacher.id}">عرض المحاضرات</a>
                    </div>
                `;
                teachersContainer.appendChild(teacherCard);

                // عرض للأدمن
                const adminTeacherCard = document.createElement('div');
                adminTeacherCard.className = 'teacher-card';
                if (darkMode) adminTeacherCard.classList.add('dark-mode');
                adminTeacherCard.innerHTML = `
                    <div class="teacher-img">${teacher.name.charAt(0)}</div>
                    <div class="teacher-info">
                        <h3 class="teacher-name">${teacher.name}</h3>
                        <p class="teacher-desc">${teacher.desc}</p>
                        <div class="action-buttons">
                            <button class="btn btn-primary manage-lectures-btn" data-teacher-id="${teacher.id}">إدارة المحاضرات</button>
                            <button class="btn btn-warning edit-teacher-btn" data-teacher-id="${teacher.id}">تعديل</button>
                            <button class="btn btn-danger delete-teacher-btn" data-teacher-id="${teacher.id}">حذف</button>
                        </div>
                    </div>
                `;
                adminTeachersContainer.appendChild(adminTeacherCard);
            });

            // إضافة مستمعي الأحداث
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const teacherId = btn.getAttribute('data-teacher-id');
                    showTeacherLectures(teacherId);
                });
            });

            document.querySelectorAll('.manage-lectures-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const teacherId = btn.getAttribute('data-teacher-id');
                    showManageLectures(teacherId);
                });
            });

            document.querySelectorAll('.edit-teacher-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const teacherId = btn.getAttribute('data-teacher-id');
                    editTeacher(teacherId);
                });
            });

            document.querySelectorAll('.delete-teacher-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const teacherId = btn.getAttribute('data-teacher-id');
                    if (confirm('هل أنت متأكد من حذف هذا المدرس وجميع محاضراته؟')) {
                        deleteTeacher(teacherId);
                    }
                });
            });
        }

        // عرض محاضرات مدرس معين للمستخدم العادي
        function showTeacherLectures(teacherId) {
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;

            lecturesTitle.textContent = `محاضرات الأستاذ ${teacher.name}`;
            lecturesContainer.innerHTML = '';

            if (!teacher.lectures || teacher.lectures.length === 0) {
                lecturesContainer.innerHTML = '<p>لا توجد محاضرات متاحة حالياً</p>';
            } else {
                teacher.lectures.forEach(lecture => {
                    const lectureItem = document.createElement('div');
                    lectureItem.className = 'lecture-item';
                    if (darkMode) lectureItem.classList.add('dark-mode');
                    lectureItem.innerHTML = `
                        <span class="lecture-title">${lecture.title}</span>
                        <a href="${lecture.link}" class="lecture-link" target="_blank">الذهاب إلى المحاضرة</a>
                    `;
                    lecturesContainer.appendChild(lectureItem);
                });
            }

            lecturesSection.style.display = 'block';
            window.scrollTo({ top: lecturesSection.offsetTop, behavior: 'smooth' });
        }

        // عرض واجهة إدارة المحاضرات للأدمن
        function showManageLectures(teacherId) {
            currentTeacherId = teacherId;
            const teacher = teachers.find(t => t.id === teacherId);
            if (!teacher) return;

            document.getElementById('manage-lectures-title').textContent = `إدارة محاضرات الأستاذ ${teacher.name}`;
            adminLecturesContainer.innerHTML = '';

            if (!teacher.lectures || teacher.lectures.length === 0) {
                adminLecturesContainer.innerHTML = '<p>لا توجد محاضرات لهذا المدرس</p>';
            } else {
                teacher.lectures.forEach(lecture => {
                    const lectureItem = document.createElement('div');
                    lectureItem.className = 'lecture-item';
                    if (darkMode) lectureItem.classList.add('dark-mode');
                    lectureItem.innerHTML = `
                        <span class="lecture-title">${lecture.title}</span>
                        <div>
                            <a href="${lecture.link}" class="btn btn-primary" target="_blank">عرض</a>
                            <button class="btn btn-warning edit-lecture-btn" data-lecture-id="${lecture.id}">تعديل</button>
                            <button class="btn btn-danger delete-lecture-btn" data-lecture-id="${lecture.id}">حذف</button>
                        </div>
                    `;
                    adminLecturesContainer.appendChild(lectureItem);
                });

                // إضافة مستمعي الأحداث للأزرار
                document.querySelectorAll('.edit-lecture-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const lectureId = btn.getAttribute('data-lecture-id');
                        editLecture(lectureId);
                    });
                });

                document.querySelectorAll('.delete-lecture-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const lectureId = btn.getAttribute('data-lecture-id');
                        if (confirm('هل أنت متأكد من حذف هذا الفصل؟')) {
                            deleteLecture(lectureId);
                        }
                    });
                });
            }

            adminTeachersSection.style.display = 'none';
            addTeacherSection.style.display = 'none';
            manageLecturesSection.style.display = 'block';
            addLectureSection.style.display = 'none';
        }

        // عرض نموذج إضافة/تعديل مدرس
        function showAddTeacherForm(editMode = false, teacherId = null) {
            if (editMode) {
                document.querySelector('#add-teacher-section .section-title').textContent = 'تعديل المدرس';
                const teacher = teachers.find(t => t.id === teacherId);
                if (teacher) {
                    document.getElementById('teacher-name').value = teacher.name;
                    document.getElementById('teacher-desc').value = teacher.desc;
                    currentTeacherId = teacherId;
                }
                isEditMode = true;
            } else {
                document.querySelector('#add-teacher-section .section-title').textContent = 'إضافة مدرس جديد';
                document.getElementById('teacher-name').value = '';
                document.getElementById('teacher-desc').value = '';
                currentTeacherId = null;
                isEditMode = false;
            }

            adminTeachersSection.style.display = 'none';
            manageLecturesSection.style.display = 'none';
            addTeacherSection.style.display = 'block';
        }

        // عرض نموذج إضافة/تعديل فصل
        function showAddLectureForm(editMode = false, lectureId = null) {
            if (editMode) {
                document.getElementById('lecture-form-title').textContent = 'تعديل الفصل';
                const teacher = teachers.find(t => t.id === currentTeacherId);
                if (teacher && teacher.lectures) {
                    const lecture = teacher.lectures.find(l => l.id === lectureId);
                    if (lecture) {
                        document.getElementById('lecture-title').value = lecture.title;
                        document.getElementById('lecture-link').value = lecture.link;
                        document.getElementById('lecture-id').value = lectureId;
                        currentLectureId = lectureId;
                    }
                }
                isEditMode = true;
            } else {
                document.getElementById('lecture-form-title').textContent = 'إضافة فصل جديد';
                document.getElementById('lecture-title').value = '';
                document.getElementById('lecture-link').value = '';
                document.getElementById('lecture-id').value = '';
                currentLectureId = null;
                isEditMode = false;
            }

            document.getElementById('teacher-id').value = currentTeacherId;
            manageLecturesSection.style.display = 'block';
            addLectureSection.style.display = 'block';
        }

        // تعديل مدرس
        function editTeacher(teacherId) {
            showAddTeacherForm(true, teacherId);
        }

        // تعديل فصل
        function editLecture(lectureId) {
            showAddLectureForm(true, lectureId);
        }

        // حذف مدرس
        function deleteTeacher(teacherId) {
            teachers = teachers.filter(t => t.id !== teacherId);
            saveData();
            renderTeachers();
            if (currentTeacherId === teacherId) {
                adminTeachersSection.style.display = 'block';
                manageLecturesSection.style.display = 'none';
                addLectureSection.style.display = 'none';
                currentTeacherId = null;
            }
        }

        // حذف فصل
        function deleteLecture(lectureId) {
            const teacherIndex = teachers.findIndex(t => t.id === currentTeacherId);
            if (teacherIndex !== -1) {
                if (!teachers[teacherIndex].lectures) teachers[teacherIndex].lectures = [];
                teachers[teacherIndex].lectures = teachers[teacherIndex].lectures.filter(l => l.id !== lectureId);
                saveData();
                showManageLectures(currentTeacherId);
            }
        }

        // حفظ البيانات في localStorage
        function saveData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
        }

        // تسجيل الدخول
        function login(username, password) {
            // بيانات تسجيل الدخول المشفرة (base64)
            const encodedUsername = 'YWE='; // aa
            const encodedPassword = 'YWE='; // aa

            const inputUsername = btoa(unescape(encodeURIComponent(username)));
            const inputPassword = btoa(unescape(encodeURIComponent(password)));

            if (inputUsername === encodedUsername && inputPassword === encodedPassword) {
                isAdmin = true;
                mainInterface.style.display = 'none';
                adminPanel.classList.add('active');
                loginModal.classList.remove('active');
                return true;
            } else {
                loginError.textContent = 'اسم المستخدم أو كلمة المرور غير صحيحة';
                loginError.style.display = 'block';
                return false;
            }
        }

        // تسجيل الخروج
        function logout() {
            isAdmin = false;
            mainInterface.style.display = 'block';
            adminPanel.classList.remove('active');
            adminTeachersSection.style.display = 'block';
            addTeacherSection.style.display = 'none';
            manageLecturesSection.style.display = 'none';
            addLectureSection.style.display = 'none';
            lecturesSection.style.display = 'none';
            currentTeacherId = null;
            currentLectureId = null;
        }

        // تبديل الوضع الليلي/النهاري
        function toggleDarkMode() {
            darkMode = !darkMode;
            localStorage.setItem('darkMode', darkMode);

            document.body.classList.toggle('dark-mode');
            document.querySelectorAll('.teacher-card, .admin-content, .login-form').forEach(el => {
                el.classList.toggle('dark-mode');
            });
            document.querySelectorAll('.lecture-item').forEach(el => {
                el.classList.toggle('dark-mode');
            });

            if (darkMode) {
                modeToggle.textContent = '☀️';
                adminModeToggle.textContent = '☀️';
            } else {
                modeToggle.textContent = '🌙';
                adminModeToggle.textContent = '🌙';
            }
        }

        // مستمعي الأحداث
        adminLoginBtn.addEventListener('click', () => {
            loginModal.classList.add('active');
        });

        closeLoginModal.addEventListener('click', () => {
            loginModal.classList.remove('active');
            loginError.style.display = 'none';
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            login(username, password);
        });

        addTeacherForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('teacher-name').value;
            const desc = document.getElementById('teacher-desc').value;

            if (isEditMode && currentTeacherId) {
                // تعديل مدرس موجود
                const teacherIndex = teachers.findIndex(t => t.id === currentTeacherId);
                if (teacherIndex !== -1) {
                    teachers[teacherIndex].name = name;
                    teachers[teacherIndex].desc = desc;
                }
            } else {
                // إضافة مدرس جديد
                const newTeacher = {
                    id: Date.now().toString(),
                    name,
                    desc,
                    lectures: []
                };
                teachers.push(newTeacher);
            }

            saveData();
            renderTeachers();
            adminTeachersSection.style.display = 'block';
            addTeacherSection.style.display = 'none';
            isEditMode = false;
            currentTeacherId = null;
        });

        cancelAddTeacher.addEventListener('click', () => {
            adminTeachersSection.style.display = 'block';
            addTeacherSection.style.display = 'none';
            isEditMode = false;
            currentTeacherId = null;
        });

        addLectureBtn.addEventListener('click', () => {
            showAddLectureForm();
        });

        lectureForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const title = document.getElementById('lecture-title').value;
            const link = document.getElementById('lecture-link').value;
            const teacherId = document.getElementById('teacher-id').value;

            const teacherIndex = teachers.findIndex(t => t.id === teacherId);
            if (teacherIndex !== -1) {
                if (!teachers[teacherIndex].lectures) teachers[teacherIndex].lectures = [];

                if (isEditMode && currentLectureId) {
                    // تعديل فصل موجود
                    const lectureIndex = teachers[teacherIndex].lectures.findIndex(l => l.id === currentLectureId);
                    if (lectureIndex !== -1) {
                        teachers[teacherIndex].lectures[lectureIndex].title = title;
                        teachers[teacherIndex].lectures[lectureIndex].link = link;
                    }
                } else {
                    // إضافة فصل جديد
                    const newLecture = {
                        id: Date.now().toString(),
                        title,
                        link
                    };
                    teachers[teacherIndex].lectures.push(newLecture);
                }

                saveData();
                showManageLectures(teacherId);
                isEditMode = false;
                currentLectureId = null;
            }
        });

        cancelLectureBtn.addEventListener('click', () => {
            addLectureSection.style.display = 'none';
            isEditMode = false;
            currentLectureId = null;
        });

        modeToggle.addEventListener('click', toggleDarkMode);
        adminModeToggle.addEventListener('click', toggleDarkMode);

        logoutLink.addEventListener('click', (e) => {
            e.preventDefault();
            logout();
        });

        addTeacherLink.addEventListener('click', (e) => {
            e.preventDefault();
            showAddTeacherForm();
        });

        adminHomeLink.addEventListener('click', (e) => {
            e.preventDefault();
            adminTeachersSection.style.display = 'block';
            addTeacherSection.style.display = 'none';
            manageLecturesSection.style.display = 'none';
            addLectureSection.style.display = 'none';
            currentTeacherId = null;
            currentLectureId = null;
        });

        // تهيئة التطبيق عند التحميل
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
